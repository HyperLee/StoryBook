@page "{index:int?}"
@model StoryBook.Pages.Dinosaurs.IndexModel
@{
    ViewData["Title"] = "æé¾ä»‹ç´¹";
    var prevButtonClass = Model.HasPrevious ? "nav-button nav-button-prev" : "nav-button nav-button-prev disabled";
    var nextButtonClass = Model.HasNext ? "nav-button nav-button-next" : "nav-button nav-button-next disabled";
}

<link rel="stylesheet" href="~/css/dinosaurs.css" asp-append-version="true" />

<div class="dinosaur-page">
    <h1 class="dinosaur-page-title">
        <span>ğŸ¦•</span>
        <span data-lang-zh="æé¾ä»‹ç´¹" data-lang-en="Meet the Dinosaurs">æé¾ä»‹ç´¹</span>
        <span>ğŸ¦–</span>
    </h1>

    <!-- æœå°‹æ¡† -->
    <div class="dinosaur-search-container">
        <div class="dinosaur-search-box">
            <span class="search-icon" aria-hidden="true">ğŸ”</span>
            <input type="text" 
                   id="dinosaurSearch" 
                   class="dinosaur-search-input" 
                   placeholder="æœå°‹æé¾..." 
                   data-lang-placeholder-zh="æœå°‹æé¾..."
                   data-lang-placeholder-en="Search dinosaurs..."
                   autocomplete="off"
                   aria-label="æœå°‹æé¾" />
            <button type="button" 
                    id="clearSearch" 
                    class="search-clear-btn" 
                    aria-label="æ¸…é™¤æœå°‹"
                    style="display: none;">
                âœ•
            </button>
        </div>
        <!-- æœå°‹çµæœä¸‹æ‹‰é¸å–® -->
        <div id="searchResults" class="search-results" role="listbox" aria-label="æœå°‹çµæœ"></div>
    </div>

    @if (Model.CurrentDinosaur is not null)
    {
        <partial name="_DinosaurCard" model="Model.CurrentDinosaur" />
    }
    else
    {
        <div class="alert alert-warning text-center" role="alert">
            <h4>ğŸ¦• ç›®å‰æ²’æœ‰æé¾è³‡æ–™</h4>
            <p>è«‹ç¨å¾Œå†è©¦ï¼Œæˆ–æª¢æŸ¥è³‡æ–™æª”æ¡ˆæ˜¯å¦æ­£ç¢ºè¨­å®šã€‚</p>
        </div>
    }

    <!-- æ›é å’Œå°èˆªæŒ‰éˆ• -->
    <div class="dinosaur-navigation">
        <!-- ä¸Šä¸€é æŒ‰éˆ• -->
        @if (Model.HasPrevious)
        {
            <a asp-page="/Dinosaurs/Index" asp-route-index="@(Model.CurrentIndex - 1)" class="@prevButtonClass">
                <span class="nav-button-icon">â¬…ï¸</span>
                <span data-lang-zh="ä¸Šä¸€é " data-lang-en="Previous">ä¸Šä¸€é </span>
            </a>
        }
        else
        {
            <span class="@prevButtonClass" aria-disabled="true">
                <span class="nav-button-icon">â¬…ï¸</span>
                <span data-lang-zh="ä¸Šä¸€é " data-lang-en="Previous">ä¸Šä¸€é </span>
            </span>
        }

        <!-- å›é¦–é æŒ‰éˆ• -->
        <a asp-page="/Index" class="nav-button nav-button-home">
            <span class="nav-button-icon">ğŸ </span>
            <span data-lang-zh="å›é¦–é " data-lang-en="Home">å›é¦–é </span>
        </a>

        <!-- ä¸‹ä¸€é æŒ‰éˆ• -->
        @if (Model.HasNext)
        {
            <a asp-page="/Dinosaurs/Index" asp-route-index="@(Model.CurrentIndex + 1)" class="@nextButtonClass">
                <span data-lang-zh="ä¸‹ä¸€é " data-lang-en="Next">ä¸‹ä¸€é </span>
                <span class="nav-button-icon">â¡ï¸</span>
            </a>
        }
        else
        {
            <span class="@nextButtonClass" aria-disabled="true">
                <span data-lang-zh="ä¸‹ä¸€é " data-lang-en="Next">ä¸‹ä¸€é </span>
                <span class="nav-button-icon">â¡ï¸</span>
            </span>
        }
    </div>

    <!-- é é¢è³‡è¨Š -->
    @if (Model.TotalCount > 0)
    {
        <div class="text-center mt-3">
            <small class="text-muted dinosaur-page-info">
                <span data-lang-zh="ç¬¬" data-lang-en="">ç¬¬</span>
                <span class="page-number">@(Model.CurrentIndex + 1)</span>
                <span>/</span>
                <span class="page-total">@Model.TotalCount</span>
                <span data-lang-zh="éš»æé¾" data-lang-en=" dinosaurs">éš»æé¾</span>
            </small>
        </div>
    }
</div>

<!-- åœ–ç‰‡å¤§åœ– Modal -->
<div id="imageModal" class="image-modal" role="dialog" aria-modal="true" aria-labelledby="modalImageAlt">
    <div class="image-modal-overlay" data-action="close-modal"></div>
    <div class="image-modal-content">
        <button class="image-modal-close" data-action="close-modal" aria-label="é—œé–‰å¤§åœ–">
            <span aria-hidden="true">âœ•</span>
        </button>
        <img id="modalImage" class="image-modal-img" src="" alt="" />
        <p id="modalImageCaption" class="image-modal-caption"></p>
    </div>
</div>

@section Scripts {
    <script>
        // æä¾›æé¾è³‡æ–™çµ¦ JavaScript æœå°‹åŠŸèƒ½
        window.dinosaurData = @Html.Raw(System.Text.Json.JsonSerializer.Serialize(Model.AllDinosaurs, new System.Text.Json.JsonSerializerOptions 
        { 
            PropertyNamingPolicy = System.Text.Json.JsonNamingPolicy.CamelCase 
        }));
    </script>
    <script src="~/js/dinosaurs.js" asp-append-version="true"></script>
}
