@page "{index:int?}"
@model StoryBook.Pages.Aquarium.IndexModel
@{
    ViewData["Title"] = "æ°´æ—é¤¨å‹•ç‰©ä»‹ç´¹";
    var prevButtonClass = Model.HasPrevious ? "nav-button nav-button-prev" : "nav-button nav-button-prev disabled";
    var nextButtonClass = Model.HasNext ? "nav-button nav-button-next" : "nav-button nav-button-next disabled";
}

<link rel="stylesheet" href="~/css/aquarium.css" asp-append-version="true" />

<div class="aquarium-page">
    @if (Model.IsCoverPage)
    {
        <!-- å°é¢é  -->
        <div class="aquarium-cover">
            <div class="cover-decoration">
                <span class="bubble bubble-1">ğŸ«§</span>
                <span class="bubble bubble-2">ğŸ«§</span>
                <span class="bubble bubble-3">ğŸ«§</span>
            </div>
            
            <div class="cover-content">
                <div class="cover-emoji">ğŸ </div>
                <h1 class="cover-title" data-lang-zh="æ°´æ—é¤¨å‹•ç‰©ä»‹ç´¹" data-lang-en="Aquarium Animals">
                    æ°´æ—é¤¨å‹•ç‰©ä»‹ç´¹
                </h1>
                <p class="cover-subtitle">
                    <span data-lang-zh="æ­¡è¿ä¾†åˆ°ç¥å¥‡çš„æµ·åº•ä¸–ç•Œï¼" data-lang-en="Welcome to the magical underwater world!">
                        æ­¡è¿ä¾†åˆ°ç¥å¥‡çš„æµ·åº•ä¸–ç•Œï¼
                    </span>
                    <br>
                    <span data-lang-zh="ä¸€èµ·ä¾†èªè­˜é€™äº›å¯æ„›çš„æµ·æ´‹æœ‹å‹å§ï¼" data-lang-en="Let's meet these adorable ocean friends!">
                        ä¸€èµ·ä¾†èªè­˜é€™äº›å¯æ„›çš„æµ·æ´‹æœ‹å‹å§ï¼
                    </span>
                </p>
                
                @if (Model.CanEnterFromCover)
                {
                    <a asp-page="/Aquarium/Index" asp-route-index="0" class="btn-enter-aquarium">
                        <span class="btn-icon">ğŸ‹</span>
                        <span data-lang-zh="é–‹å§‹æ¢ç´¢" data-lang-en="Start Exploring">é–‹å§‹æ¢ç´¢</span>
                    </a>
                }
                
                <div class="cover-stats">
                    <span data-lang-zh="å…± @Model.TotalCount ç¨®æµ·æ´‹å‹•ç‰©ç­‰ä½ ä¾†èªè­˜" data-lang-en="@Model.TotalCount ocean animals waiting for you">
                        å…± @Model.TotalCount ç¨®æµ·æ´‹å‹•ç‰©ç­‰ä½ ä¾†èªè­˜
                    </span>
                </div>
            </div>
            
            <div class="cover-animals">
                <span class="animal-icon">ğŸ™</span>
                <span class="animal-icon">ğŸ¦ˆ</span>
                <span class="animal-icon">ğŸ¢</span>
                <span class="animal-icon">ğŸ¦‘</span>
                <span class="animal-icon">ğŸ¡</span>
            </div>
        </div>
    }
    else
    {
        <!-- å‹•ç‰©å…§å®¹é  -->
        <h1 class="aquarium-page-title">
            <span>ğŸ </span>
            <span data-lang-zh="æ°´æ—é¤¨å‹•ç‰©ä»‹ç´¹" data-lang-en="Aquarium Animals">æ°´æ—é¤¨å‹•ç‰©ä»‹ç´¹</span>
            <span>ğŸŸ</span>
        </h1>

        @if (Model.CurrentAnimal is not null)
        {
            <div class="aquarium-animal-card" data-animal-id="@Model.CurrentAnimal.Id">
                <!-- å‹•ç‰©åœ–ç‰‡ -->
                <div class="animal-image-container">
                    <img src="@Model.CurrentAnimal.Images.Main" 
                         alt="@Model.CurrentAnimal.Name.Zh" 
                         class="animal-image"
                         onerror="this.onerror=null; this.src='/images/placeholder.svg';"
                         loading="lazy" />
                </div>

                <!-- å‹•ç‰©è³‡è¨Š -->
                <div class="animal-info">
                    <!-- åç¨± -->
                    <h2 class="animal-name" data-lang-zh="@Model.CurrentAnimal.Name.Zh" data-lang-en="@Model.CurrentAnimal.Name.En">
                        @Model.CurrentAnimal.Name.Zh
                    </h2>
                    <p class="animal-name-en">@Model.CurrentAnimal.Name.En</p>

                    <!-- å±¬æ€§æ¨™ç±¤ -->
                    <div class="animal-attributes">
                        <!-- ç”Ÿæ´»å€åŸŸ -->
                        @{
                            var zoneName = Model.CurrentAnimal.HabitatZone.GetDisplayName();
                            var zoneCss = Model.CurrentAnimal.HabitatZone.GetCssClass();
                        }
                        <span class="animal-attribute @zoneCss">
                            <span>ğŸŒŠ</span>
                            <span data-lang-zh="@zoneName.Zh" data-lang-en="@zoneName.En">
                                @zoneName.Zh
                            </span>
                        </span>

                        <!-- é£Ÿæ€§ -->
                        @{
                            var isCarnivore = Model.CurrentAnimal.Diet.En.Contains("Carnivore", StringComparison.OrdinalIgnoreCase);
                            var dietClass = isCarnivore ? "attribute-diet carnivore" : "attribute-diet";
                            var dietIcon = isCarnivore ? "ğŸ–" : "ğŸŒ¿";
                        }
                        <span class="animal-attribute @dietClass">
                            <span>@dietIcon</span>
                            <span data-lang-zh="@Model.CurrentAnimal.Diet.Zh" data-lang-en="@Model.CurrentAnimal.Diet.En">
                                @Model.CurrentAnimal.Diet.Zh
                            </span>
                        </span>

                        <!-- åˆ†ä½ˆåœ°é» -->
                        <span class="animal-attribute attribute-location">
                            <span>ğŸ“</span>
                            <span data-lang-zh="@Model.CurrentAnimal.Location.Zh" data-lang-en="@Model.CurrentAnimal.Location.En">
                                @Model.CurrentAnimal.Location.Zh
                            </span>
                        </span>
                    </div>

                    <!-- ç”Ÿæ´»ç’°å¢ƒ -->
                    <p class="animal-habitat">
                        <strong>ğŸ  
                            <span data-lang-zh="ç”Ÿæ´»ç’°å¢ƒ" data-lang-en="Habitat">ç”Ÿæ´»ç’°å¢ƒ</span>ï¼š
                        </strong>
                        <span data-lang-zh="@Model.CurrentAnimal.Habitat.Zh" data-lang-en="@Model.CurrentAnimal.Habitat.En">
                            @Model.CurrentAnimal.Habitat.Zh
                        </span>
                    </p>

                    <!-- é«”å‹æè¿°ï¼ˆå¦‚æœæœ‰ï¼‰ -->
                    @if (Model.CurrentAnimal.Size is not null)
                    {
                        <p class="animal-size">
                            <strong>ğŸ“ 
                                <span data-lang-zh="é«”å‹" data-lang-en="Size">é«”å‹</span>ï¼š
                            </strong>
                            <span data-lang-zh="@Model.CurrentAnimal.Size.Zh" data-lang-en="@Model.CurrentAnimal.Size.En">
                                @Model.CurrentAnimal.Size.Zh
                            </span>
                        </p>
                    }

                    <!-- ä»‹ç´¹æ–‡å­— -->
                    <div class="animal-description" data-lang-zh="@Model.CurrentAnimal.Description.Zh" data-lang-en="@Model.CurrentAnimal.Description.En">
                        @Model.CurrentAnimal.Description.Zh
                    </div>

                    <!-- å‹•ç‰©å°æ•…äº‹å€å¡Š -->
                    @if (Model.CurrentAnimal.Story is not null)
                    {
                        <div class="animal-story-section">
                            <h3 class="story-title">
                                <span class="story-icon">ğŸ“–</span>
                                <span data-lang-zh="å°æ•…äº‹" data-lang-en="Story Time">å°æ•…äº‹</span>
                            </h3>
                            <div class="story-content" data-lang-zh="@Model.CurrentAnimal.Story.Zh" data-lang-en="@Model.CurrentAnimal.Story.En">
                                @Model.CurrentAnimal.Story.Zh
                            </div>
                        </div>
                    }
                </div>
            </div>
        }
        else
        {
            <div class="alert alert-warning text-center" role="alert">
                <h4>ğŸ  ç›®å‰æ²’æœ‰å‹•ç‰©è³‡æ–™</h4>
                <p data-lang-zh="è«‹ç¨å¾Œå†è©¦ï¼Œæˆ–æª¢æŸ¥è³‡æ–™æª”æ¡ˆæ˜¯å¦æ­£ç¢ºè¨­å®šã€‚" data-lang-en="Please try again later or check if the data file is set up correctly.">
                    è«‹ç¨å¾Œå†è©¦ï¼Œæˆ–æª¢æŸ¥è³‡æ–™æª”æ¡ˆæ˜¯å¦æ­£ç¢ºè¨­å®šã€‚
                </p>
            </div>
        }

        <!-- æ›é å’Œå°èˆªæŒ‰éˆ• -->
        <div class="aquarium-navigation">
            <!-- ä¸Šä¸€é æŒ‰éˆ• -->
            @if (Model.HasPrevious)
            {
                <a asp-page="/Aquarium/Index" asp-route-index="@(Model.CurrentIndex - 1)" class="@prevButtonClass">
                    <span class="nav-button-icon">â¬…ï¸</span>
                    <span data-lang-zh="ä¸Šä¸€é " data-lang-en="Previous">ä¸Šä¸€é </span>
                </a>
            }
            else
            {
                <span class="@prevButtonClass" aria-disabled="true">
                    <span class="nav-button-icon">â¬…ï¸</span>
                    <span data-lang-zh="ä¸Šä¸€é " data-lang-en="Previous">ä¸Šä¸€é </span>
                </span>
            }

            <!-- å›é¦–é æŒ‰éˆ• -->
            <a asp-page="/Index" class="nav-button nav-button-home">
                <span class="nav-button-icon">ğŸ </span>
                <span data-lang-zh="å›é¦–é " data-lang-en="Home">å›é¦–é </span>
            </a>

            <!-- ä¸‹ä¸€é æŒ‰éˆ• -->
            @if (Model.HasNext)
            {
                <a asp-page="/Aquarium/Index" asp-route-index="@(Model.CurrentIndex + 1)" class="@nextButtonClass">
                    <span data-lang-zh="ä¸‹ä¸€é " data-lang-en="Next">ä¸‹ä¸€é </span>
                    <span class="nav-button-icon">â¡ï¸</span>
                </a>
            }
            else
            {
                <span class="@nextButtonClass" aria-disabled="true">
                    <span data-lang-zh="ä¸‹ä¸€é " data-lang-en="Next">ä¸‹ä¸€é </span>
                    <span class="nav-button-icon">â¡ï¸</span>
                </span>
            }
        </div>

        <!-- é é¢è³‡è¨Š -->
        @if (Model.TotalCount > 0)
        {
            <div class="text-center mt-3">
                <small class="text-muted aquarium-page-info">
                    <span data-lang-zh="ç¬¬" data-lang-en="">ç¬¬</span>
                    <span class="page-number">@(Model.CurrentIndex + 1)</span>
                    <span data-lang-zh="é ï¼Œå…±" data-lang-en="of"> é ï¼Œå…± </span>
                    <span class="total-pages">@Model.TotalCount</span>
                    <span data-lang-zh="é " data-lang-en="pages"> é </span>
                </small>
            </div>
        }
    }
</div>

@section Scripts {
    <script src="~/js/aquarium.js" asp-append-version="true"></script>
}
